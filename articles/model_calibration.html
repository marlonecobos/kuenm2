<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Model Calibration • kuenm2</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model Calibration">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">kuenm2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.10</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/basic_bata_cleaning.html">Occurrene Data Cleaning</a></li>
    <li><a class="dropdown-item" href="../articles/model_calibration.html">Model Calibration</a></li>
    <li><a class="dropdown-item" href="../articles/prepare_data.html">Prepare Data for Model Calibration</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Model Calibration</h1>
            
      

      <div class="d-none name"><code>model_calibration.Rmd</code></div>
    </div>

    
    
<ul>
<li><a href="#introduction">Introduction</a></li>
<li>
<a href="#calibration">Calibration</a>
<ul>
<li><a href="#concave-curves">Concave curves</a></li>
</ul>
</li>
<li><a href="#re-selecting-models">Re-selecting models</a></li>
<li><a href="#saving-a-calibration_results-object">Saving a
calibration_results object</a></li>
</ul>
<hr>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Model calibration is the most computationally challenging process
automated in <strong>kuenm2</strong>. In this step, candidate models are
trained and tested using a k-fold cross-validation approach. Then,
models are selected based on multiple criteria to warranty that the
models used in later steps are the most robust among the candidates. The
main function used in this step is <code><a href="../reference/calibration.html">calibration()</a></code>.</p>
<p>To start the calibration process, we need a
<code>prepared_data</code> object. For more details in data preparation,
please refer to the vignette <a href="/articles/prepared_data.html">prepare data for model
calibration</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Load packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://marlonecobos.github.io/kuenm2/">kuenm2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; terra 1.8.54</span></span>
<span><span class="co"># Import occurrences</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">occ_data</span>, package <span class="op">=</span> <span class="st">"kuenm2"</span><span class="op">)</span></span>
<span><span class="co"># Import raster layers</span></span>
<span><span class="va">var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Current_variables.tif"</span>, package <span class="op">=</span> <span class="st">"kuenm2"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Prepare data for maxnet model</span></span>
<span><span class="va">d_maxnet</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_data.html">prepare_data</a></span><span class="op">(</span>algorithm <span class="op">=</span> <span class="st">"maxnet"</span>,</span>
<span>                         occ <span class="op">=</span> <span class="va">occ_data</span>,</span>
<span>                         x <span class="op">=</span> <span class="st">"x"</span>, y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                         raster_variables <span class="op">=</span> <span class="va">var</span>,</span>
<span>                         species <span class="op">=</span> <span class="st">"Myrcia hatschbachii"</span>,</span>
<span>                         categorical_variables <span class="op">=</span> <span class="st">"SoilType"</span>,</span>
<span>                         n_background <span class="op">=</span> <span class="fl">300</span>,</span>
<span>                         features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"q"</span>, <span class="st">"lq"</span>, <span class="st">"lqp"</span><span class="op">)</span>,</span>
<span>                         r_multiplier <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level2">
<h2 id="calibration">Calibration<a class="anchor" aria-label="anchor" href="#calibration"></a>
</h2>
<p>The <code><a href="../reference/calibration.html">calibration()</a></code> function fits and evaluates candidate
models considering the follow metrics:</p>
<ul>
<li>Omission error: calculated using models trained with separate
testing data subsets. Users can specify multiple omission rates to be
considered (e.g., c(5%, 10%)), though only one can be used as the
threshold for selecting the best models.</li>
<li>Partial ROC: calculated following <a href="http://dx.doi.org/10.1016/j.ecolmodel.2007.11.008" class="external-link">Peterson et
al. (2008)</a>.</li>
<li>Model complexity (AIC): assessed using models generated with the
complete set of occurrences.</li>
<li>Unimodality (optional): Assessed through the beta coefficients of
quadratic terms, following <a href="https://journals.ku.edu/jbi/article/view/21742" class="external-link">Arias-Giraldo
&amp; Cobos (2024)</a>.</li>
</ul>
<p><br></p>
<p>In summary, to calibrate and evaluate the models, the function
requires a <code>prepared_data</code> object and the following
definitions:</p>
<ul>
<li>
<strong>Omission Errors:</strong> Values ranging from 0 to 100,
representing the percentage of potential error attributed to various
sources of uncertainty in the data. These values are utilized in the
calculation of omission rates and partial ROC.</li>
<li>
<strong>Omission Rate for Model Selection:</strong> The specific
omission error threshold used to select models. This value defines the
maximum omission rate a candidate model can have to be considered for
selection.</li>
<li>
<strong>Removal of Concave Curves:</strong> A specification of
whether to exclude candidate models that exhibit concave curves.</li>
</ul>
<p>Optional arguments allow for modifications such as changing the delta
AIC threshold for model selection (default is 2), determining whether to
add presence samples to the background (default is <code>TRUE</code>),
and whether to employ user-specified weights. For a comprehensive
description of all arguments, refer to <code><a href="../reference/calibration.html">?calibration</a></code>.</p>
<p>In this example, we will evaluate the models considering two omission
errors (5% and 10%), with model selection based on the 10% omission
error. To improve computational speed, you can set <code>parallel</code>
to <code>TRUE</code> and specify the number of cores to utilize; the
candidate models will be distributed among these cores. To detect the
number of available cores on your machine, run
<code><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">parallel::detectCores()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calibration.html">calibration</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">d_maxnet</span>, </span>
<span>                 error_considered <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>                 omission_rate <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                 parallel <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">#Set TRUE to run in parallel</span></span>
<span>                 ncores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co">#Define number of cores</span></span>
<span><span class="co">#&gt; Task 1/1: fitting and evaluating models:</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |=======                                                               |  11%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |==========================================                            |  61%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model selection step:</span></span>
<span><span class="co">#&gt; Selecting best among 300 models.</span></span>
<span><span class="co">#&gt; Calculating pROC...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Filtering 300 models.</span></span>
<span><span class="co">#&gt; Removing 0 model(s) because they failed to fit.</span></span>
<span><span class="co">#&gt; 156 models were selected with omission rate below 10%.</span></span>
<span><span class="co">#&gt; Selecting 1 final model(s) with delta AIC &lt;2.</span></span>
<span><span class="co">#&gt; Validating pROC of selected models...</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; All selected models have significant pROC values.</span></span></code></pre></div>
<p>The <code><a href="../reference/calibration.html">calibration()</a></code> function returns a
<code>calibration_results</code> object, a list containing various
essential pieces of information from the model calibration process. The
elements of the <code>calibration_results</code> object can be explored
by indexing them. For example, all evaluation metrics are stored within
the <code>calibration_results</code> element:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># See first rows of the summary of calibration results</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">m</span><span class="op">$</span><span class="va">calibration_results</span><span class="op">$</span><span class="va">Summary</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"Omission_rate_at_10.mean"</span>, <span class="st">"AICc"</span>,</span>
<span>                                      <span class="st">"Is_concave"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   ID Omission_rate_at_10.mean     AICc Is_concave</span></span>
<span><span class="co">#&gt; 1  1                   0.0785 564.6870      FALSE</span></span>
<span><span class="co">#&gt; 2  2                   0.0785 564.7657      FALSE</span></span>
<span><span class="co">#&gt; 3  3                   0.0785 564.7059      FALSE</span></span>
<span><span class="co">#&gt; 4  4                   0.1571 574.4960      FALSE</span></span>
<span><span class="co">#&gt; 5  5                   0.1378 574.4347      FALSE</span></span>
<span><span class="co">#&gt; 6  6                   0.1170 574.4141      FALSE</span></span></code></pre></div>
<p><br></p>
<p>We can also examine the details of the selected models:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># See first rows of the summary of calibration results</span></span>
<span><span class="va">m</span><span class="op">$</span><span class="va">selected_models</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"Formulas"</span>, <span class="st">"R_multiplier"</span>, </span>
<span>                     <span class="st">"Omission_rate_at_10.mean"</span>, <span class="st">"AICc"</span>, <span class="st">"Is_concave"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;      ID                                                           Formulas</span></span>
<span><span class="co">#&gt; 192 192 ~bio_1 + bio_7 + bio_15 + I(bio_1^2) + I(bio_7^2) + I(bio_15^2) -1</span></span>
<span><span class="co">#&gt;     R_multiplier Omission_rate_at_10.mean     AICc Is_concave</span></span>
<span><span class="co">#&gt; 192          0.1                   0.0769 522.9691      FALSE</span></span></code></pre></div>
<p><br></p>
<p>When printed, the <code>calibration_results</code> object provides a
summary of the model selection process. This includes the total number
of candidate models considered, the number of models that failed to fit,
and the number of models exhibiting concave curves (along with an
indication of whether these were removed). Additionally, it reports the
number of models excluded due to non-significant partial ROC (pROC)
values, high omission error rates, or elevated AIC values. Finally, a
summary of the metrics for the selected models is presented.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt; calibration_results object summary (maxnet)</span></span>
<span><span class="co">#&gt; =============================================================</span></span>
<span><span class="co">#&gt; Species: Myrcia hatschbachii </span></span>
<span><span class="co">#&gt; Number of candidate models: 300 </span></span>
<span><span class="co">#&gt;   - Models removed because they failed to fit: 0 </span></span>
<span><span class="co">#&gt;   - Models identified with concave curves: 35 </span></span>
<span><span class="co">#&gt;   - Model with concave curves not removed </span></span>
<span><span class="co">#&gt;   - Models removed with non-significant values of pROC: 0 </span></span>
<span><span class="co">#&gt;   - Models removed with omission error &gt; 10%: 144 </span></span>
<span><span class="co">#&gt;   - Models removed with delta AIC &gt; 2: 155 </span></span>
<span><span class="co">#&gt; Selected models: 1 </span></span>
<span><span class="co">#&gt;   - Up to 5 printed here:</span></span>
<span><span class="co">#&gt;      ID                                                           Formulas</span></span>
<span><span class="co">#&gt; 192 192 ~bio_1 + bio_7 + bio_15 + I(bio_1^2) + I(bio_7^2) + I(bio_15^2) -1</span></span>
<span><span class="co">#&gt;     Features R_multiplier pval_pROC_at_10.mean Omission_rate_at_10.mean dAIC</span></span>
<span><span class="co">#&gt; 192       lq          0.1                    0                   0.0769    0</span></span>
<span><span class="co">#&gt;     Parameters</span></span>
<span><span class="co">#&gt; 192          5</span></span></code></pre></div>
<p><br></p>
<p>In this example, of the 300 candidate models fitted, only one was
selected based on a significant pROC value, a low omission error
(&lt;10%), and a low AIC score (&lt;2).</p>
<div class="section level3">
<h3 id="concave-curves">Concave curves<a class="anchor" aria-label="anchor" href="#concave-curves"></a>
</h3>
<p>It is worth noting that 35 models were identified as having concave
curves. Concave (or bimodal) curves indicate that the peak suitability
is found at the extremes of the variable range. For example, as shown in
the right panel of the figure below, higher suitability is observed in
both the driest and wettest regions, with lower suitabilities occurring
at intermediate precipitation levels.</p>
<p><img src="vignettes_img/concave_curves.png" width="75%"></p>
<p><br></p>
<p>In our example, none of the selected models have concave curves:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span><span class="op">$</span><span class="va">selected_models</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"Formulas"</span>, <span class="st">"Is_concave"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;      ID                                                           Formulas</span></span>
<span><span class="co">#&gt; 192 192 ~bio_1 + bio_7 + bio_15 + I(bio_1^2) + I(bio_7^2) + I(bio_15^2) -1</span></span>
<span><span class="co">#&gt;     Is_concave</span></span>
<span><span class="co">#&gt; 192      FALSE</span></span></code></pre></div>
<p><br></p>
<p>However, occasionally, a model with concave curves might be selected
if it has sufficiently low omission rate and AIC values. To
<strong>ensure that none of the selected models have concave
curves</strong>, you can set <code>remove_concave = TRUE</code> within
the <code><a href="../reference/calibration.html">calibration()</a></code> function:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_unimodal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calibration.html">calibration</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">d_maxnet</span>, </span>
<span>                 remove_concave <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># Ensures concave models are not selected</span></span>
<span>                 error_considered <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>                 omission_rate <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; Task 1/2: checking for concave responses in models:</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |=========                                                             |  14%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |============================================                          |  64%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Task 2/2: fitting and evaluating models with no concave responses:</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |===========                                                           |  15%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |=====================                                                 |  29%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |==============================                                        |  42%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |========================================================              |  79%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |=================================================================     |  92%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model selection step:</span></span>
<span><span class="co">#&gt; Selecting best among 370 models.</span></span>
<span><span class="co">#&gt; Calculating pROC...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Filtering 370 models.</span></span>
<span><span class="co">#&gt; Removing 0 model(s) because they failed to fit.</span></span>
<span><span class="co">#&gt; Removing 105 model(s) with concave curves.</span></span>
<span><span class="co">#&gt; 135 models were selected with omission rate below 10%.</span></span>
<span><span class="co">#&gt; Selecting 1 final model(s) with delta AIC &lt;2.</span></span>
<span><span class="co">#&gt; Validating pROC of selected models...</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; All selected models have significant pROC values.</span></span></code></pre></div>
<p><br></p>
<p>Note that the process is now divided into two tasks:</p>
<ul>
<li><p>Task 1/2: Only candidate models that include quadratic terms are
fitted. For Maxent models (using the maxnet algorithm), the function
first fits the candidate model with the highest regularization
multiplier (e.g., 5) for each formula. This approach is used because if
a particular formula produces a concave response at a high
regularization value, it will also produce concave responses at lower
regularization values. By checking the model with the highest
regularization first, the function can skip fitting the other models
with the same formula but lower regularization values, saving time and
computation.</p></li>
<li>
<p>Task 2/2: In this step, the function fits and evaluates two
groups of models:</p>
<ul>
<li>Models without quadratic terms.</li>
<li>Models with quadratic terms, but only those with formulas that did
not produce concave responses in Task 1/2 (i.e., they passed the
concavity check at the higher regularization multiplier).</li>
</ul>
</li>
</ul>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="re-selecting-models">Re-selecting models<a class="anchor" aria-label="anchor" href="#re-selecting-models"></a>
</h2>
<p>The model selection procedure is conducted internally during the
calibration process. However, it is possible to re-select models by
considering other omission rates (since these were calculated during
calibration), model complexity (delta AIC) and concave curves.</p>
<p>By default, <code><a href="../reference/calibration.html">calibration()</a></code> calculates pROC values only
for the selected models to optimize computational time. Consequently,
pROC values for non-selected models are filled with <code>NA</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># See first rows of the summary of calibration results (pROC values)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">m</span><span class="op">$</span><span class="va">calibration_results</span><span class="op">$</span><span class="va">Summary</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"Mean_AUC_ratio_at_10.mean"</span>,</span>
<span>                                 <span class="st">"pval_pROC_at_10.mean"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   ID Mean_AUC_ratio_at_10.mean pval_pROC_at_10.mean</span></span>
<span><span class="co">#&gt; 1  1                        NA                   NA</span></span>
<span><span class="co">#&gt; 2  2                        NA                   NA</span></span>
<span><span class="co">#&gt; 3  3                        NA                   NA</span></span>
<span><span class="co">#&gt; 4  4                        NA                   NA</span></span>
<span><span class="co">#&gt; 5  5                        NA                   NA</span></span>
<span><span class="co">#&gt; 6  6                        NA                   NA</span></span>
<span><span class="co"># See pROC values of selected models</span></span>
<span><span class="va">m</span><span class="op">$</span><span class="va">selected_models</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"Mean_AUC_ratio_at_10.mean"</span>,</span>
<span>                                 <span class="st">"pval_pROC_at_10.mean"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;      ID Mean_AUC_ratio_at_10.mean pval_pROC_at_10.mean</span></span>
<span><span class="co">#&gt; 192 192                  1.434188                    0</span></span></code></pre></div>
<p><br></p>
<p>When pROC is not calculated for all models during
<code>calibration</code>, the <code><a href="../reference/select_models.html">select_models()</a></code> function
requires the <code>prepared_data</code> used during the calibration
step, and <code>compute_proc</code> must be set to
<code>TRUE</code>.</p>
<p>For instance, let’s re-select models from the calibration results,
applying an omission rate of 5% and a delta AIC of 10.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_models.html">select_models</a></span><span class="op">(</span>calibration_results <span class="op">=</span> <span class="va">m</span>, </span>
<span>                       data <span class="op">=</span> <span class="va">d_maxnet</span>, <span class="co">#Necessary for computing pROC</span></span>
<span>                       compute_proc <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                       omission_rate <span class="op">=</span> <span class="fl">5</span>, <span class="co"># New omission rate</span></span>
<span>                       delta_aic <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># New Delta AIC</span></span>
<span><span class="co">#&gt; Selecting best among 300 models.</span></span>
<span><span class="co">#&gt; Calculating pROC...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Filtering 300 models.</span></span>
<span><span class="co">#&gt; Removing 0 model(s) because they failed to fit.</span></span>
<span><span class="co">#&gt; 153 models were selected with omission rate below 5%.</span></span>
<span><span class="co">#&gt; Selecting 5 final model(s) with delta AIC &lt;10.</span></span>
<span><span class="co">#&gt; Validating pROC of selected models...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; All selected models have significant pROC values.</span></span>
<span><span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">new_m</span><span class="op">)</span></span>
<span><span class="co">#&gt; calibration_results object summary (maxnet)</span></span>
<span><span class="co">#&gt; =============================================================</span></span>
<span><span class="co">#&gt; Species: Myrcia hatschbachii </span></span>
<span><span class="co">#&gt; Number of candidate models: 300 </span></span>
<span><span class="co">#&gt;   - Models removed because they failed to fit: 0 </span></span>
<span><span class="co">#&gt;   - Models identified with concave curves: 35 </span></span>
<span><span class="co">#&gt;   - Model with concave curves not removed </span></span>
<span><span class="co">#&gt;   - Models removed with non-significant values of pROC: 0 </span></span>
<span><span class="co">#&gt;   - Models removed with omission error &gt; 5%: 147 </span></span>
<span><span class="co">#&gt;   - Models removed with delta AIC &gt; 10: 148 </span></span>
<span><span class="co">#&gt; Selected models: 5 </span></span>
<span><span class="co">#&gt;   - Up to 5 printed here:</span></span>
<span><span class="co">#&gt;      ID</span></span>
<span><span class="co">#&gt; 159 159</span></span>
<span><span class="co">#&gt; 160 160</span></span>
<span><span class="co">#&gt; 189 189</span></span>
<span><span class="co">#&gt; 237 237</span></span>
<span><span class="co">#&gt; 254 254</span></span>
<span><span class="co">#&gt;                                                                                                           Formulas</span></span>
<span><span class="co">#&gt; 159                                                                    ~bio_1 + bio_7 + I(bio_1^2) + I(bio_7^2) -1</span></span>
<span><span class="co">#&gt; 160                                                                  ~bio_1 + bio_12 + I(bio_1^2) + I(bio_12^2) -1</span></span>
<span><span class="co">#&gt; 189                                             ~bio_1 + bio_7 + bio_12 + I(bio_1^2) + I(bio_7^2) + I(bio_12^2) -1</span></span>
<span><span class="co">#&gt; 237                                                      ~bio_1 + bio_7 + I(bio_1^2) + I(bio_7^2) + bio_1:bio_7 -1</span></span>
<span><span class="co">#&gt; 254 ~bio_1 + bio_7 + bio_12 + I(bio_1^2) + I(bio_7^2) + I(bio_12^2) + bio_1:bio_7 + bio_1:bio_12 + bio_7:bio_12 -1</span></span>
<span><span class="co">#&gt;     Features R_multiplier pval_pROC_at_5.mean Omission_rate_at_5.mean      dAIC</span></span>
<span><span class="co">#&gt; 159       lq          0.1                   0                  0.0192 0.4418045</span></span>
<span><span class="co">#&gt; 160       lq          0.1                   0                  0.0192 7.7508108</span></span>
<span><span class="co">#&gt; 189       lq          0.1                   0                  0.0192 0.0000000</span></span>
<span><span class="co">#&gt; 237      lqp          0.1                   0                  0.0192 3.1458802</span></span>
<span><span class="co">#&gt; 254      lqp          0.1                   0                  0.0192 6.6729091</span></span>
<span><span class="co">#&gt;     Parameters</span></span>
<span><span class="co">#&gt; 159          3</span></span>
<span><span class="co">#&gt; 160          4</span></span>
<span><span class="co">#&gt; 189          5</span></span>
<span><span class="co">#&gt; 237          3</span></span>
<span><span class="co">#&gt; 254          6</span></span></code></pre></div>
<p><br></p>
<p>If a <code>calibration_results</code> object is provided,
<code>select_models</code> will return a
<code>calibration_results</code> output with the selected models and
summary updated. Note that we now have 5 models selected:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_m</span><span class="op">$</span><span class="va">selected_models</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"Formulas"</span>, <span class="st">"R_multiplier"</span>, </span>
<span>                     <span class="st">"Omission_rate_at_5.mean"</span>, <span class="st">"Mean_AUC_ratio_at_10.mean"</span>,</span>
<span>                     <span class="st">"AICc"</span>, <span class="st">"Is_concave"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;      ID</span></span>
<span><span class="co">#&gt; 159 159</span></span>
<span><span class="co">#&gt; 160 160</span></span>
<span><span class="co">#&gt; 189 189</span></span>
<span><span class="co">#&gt; 237 237</span></span>
<span><span class="co">#&gt; 254 254</span></span>
<span><span class="co">#&gt;                                                                                                           Formulas</span></span>
<span><span class="co">#&gt; 159                                                                    ~bio_1 + bio_7 + I(bio_1^2) + I(bio_7^2) -1</span></span>
<span><span class="co">#&gt; 160                                                                  ~bio_1 + bio_12 + I(bio_1^2) + I(bio_12^2) -1</span></span>
<span><span class="co">#&gt; 189                                             ~bio_1 + bio_7 + bio_12 + I(bio_1^2) + I(bio_7^2) + I(bio_12^2) -1</span></span>
<span><span class="co">#&gt; 237                                                      ~bio_1 + bio_7 + I(bio_1^2) + I(bio_7^2) + bio_1:bio_7 -1</span></span>
<span><span class="co">#&gt; 254 ~bio_1 + bio_7 + bio_12 + I(bio_1^2) + I(bio_7^2) + I(bio_12^2) + bio_1:bio_7 + bio_1:bio_12 + bio_7:bio_12 -1</span></span>
<span><span class="co">#&gt;     R_multiplier Omission_rate_at_5.mean Mean_AUC_ratio_at_10.mean     AICc</span></span>
<span><span class="co">#&gt; 159          0.1                  0.0192                        NA 528.3151</span></span>
<span><span class="co">#&gt; 160          0.1                  0.0192                        NA 535.6241</span></span>
<span><span class="co">#&gt; 189          0.1                  0.0192                        NA 527.8733</span></span>
<span><span class="co">#&gt; 237          0.1                  0.0192                        NA 531.0192</span></span>
<span><span class="co">#&gt; 254          0.1                  0.0192                        NA 534.5462</span></span>
<span><span class="co">#&gt;     Is_concave</span></span>
<span><span class="co">#&gt; 159      FALSE</span></span>
<span><span class="co">#&gt; 160      FALSE</span></span>
<span><span class="co">#&gt; 189      FALSE</span></span>
<span><span class="co">#&gt; 237      FALSE</span></span>
<span><span class="co">#&gt; 254      FALSE</span></span></code></pre></div>
<p><br></p>
<p>You can also provide a <code>data.frame</code> containing the
evaluation metrics for each candidate model directly to
<code><a href="../reference/select_models.html">select_models()</a></code>. This <code>data.frame</code> is available
in the output of the <code><a href="../reference/calibration.html">calibration()</a></code> function under
<code>object$calibration_results$Summary</code>. In this case, the
function will return a list containing the selected models along with
summaries of the model selection process.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Re-select models using data.frame</span></span>
<span><span class="va">new_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_models.html">select_models</a></span><span class="op">(</span>candidate_models <span class="op">=</span> <span class="va">m</span><span class="op">$</span><span class="va">calibration_results</span><span class="op">$</span><span class="va">Summary</span>,</span>
<span>                             data <span class="op">=</span> <span class="va">d_maxnet</span>, <span class="co">#Necessary for computing pROC</span></span>
<span>                             compute_proc <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                             omission_rate <span class="op">=</span> <span class="fl">5</span>, <span class="co"># New omission rate</span></span>
<span>                             delta_aic <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># New Delta AIC</span></span>
<span><span class="co">#&gt; Selecting best among 300 models.</span></span>
<span><span class="co">#&gt; Calculating pROC...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Filtering 300 models.</span></span>
<span><span class="co">#&gt; Removing 0 model(s) because they failed to fit.</span></span>
<span><span class="co">#&gt; 153 models were selected with omission rate below 5%.</span></span>
<span><span class="co">#&gt; Selecting 5 final model(s) with delta AIC &lt;10.</span></span>
<span><span class="co">#&gt; Validating pROC of selected models...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; All selected models have significant pROC values.</span></span>
<span></span>
<span><span class="co">#Get class of object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">new_summary</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "list"</span></span>
<span></span>
<span><span class="co">#See selected models</span></span>
<span><span class="va">new_summary</span><span class="op">$</span><span class="va">selected_models</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"Formulas"</span>, <span class="st">"R_multiplier"</span>, </span>
<span>                     <span class="st">"Omission_rate_at_5.mean"</span>, <span class="st">"Mean_AUC_ratio_at_10.mean"</span>,</span>
<span>                     <span class="st">"AICc"</span>, <span class="st">"Is_concave"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;      ID</span></span>
<span><span class="co">#&gt; 159 159</span></span>
<span><span class="co">#&gt; 160 160</span></span>
<span><span class="co">#&gt; 189 189</span></span>
<span><span class="co">#&gt; 237 237</span></span>
<span><span class="co">#&gt; 254 254</span></span>
<span><span class="co">#&gt;                                                                                                           Formulas</span></span>
<span><span class="co">#&gt; 159                                                                    ~bio_1 + bio_7 + I(bio_1^2) + I(bio_7^2) -1</span></span>
<span><span class="co">#&gt; 160                                                                  ~bio_1 + bio_12 + I(bio_1^2) + I(bio_12^2) -1</span></span>
<span><span class="co">#&gt; 189                                             ~bio_1 + bio_7 + bio_12 + I(bio_1^2) + I(bio_7^2) + I(bio_12^2) -1</span></span>
<span><span class="co">#&gt; 237                                                      ~bio_1 + bio_7 + I(bio_1^2) + I(bio_7^2) + bio_1:bio_7 -1</span></span>
<span><span class="co">#&gt; 254 ~bio_1 + bio_7 + bio_12 + I(bio_1^2) + I(bio_7^2) + I(bio_12^2) + bio_1:bio_7 + bio_1:bio_12 + bio_7:bio_12 -1</span></span>
<span><span class="co">#&gt;     R_multiplier Omission_rate_at_5.mean Mean_AUC_ratio_at_10.mean     AICc</span></span>
<span><span class="co">#&gt; 159          0.1                  0.0192                        NA 528.3151</span></span>
<span><span class="co">#&gt; 160          0.1                  0.0192                        NA 535.6241</span></span>
<span><span class="co">#&gt; 189          0.1                  0.0192                        NA 527.8733</span></span>
<span><span class="co">#&gt; 237          0.1                  0.0192                        NA 531.0192</span></span>
<span><span class="co">#&gt; 254          0.1                  0.0192                        NA 534.5462</span></span>
<span><span class="co">#&gt;     Is_concave</span></span>
<span><span class="co">#&gt; 159      FALSE</span></span>
<span><span class="co">#&gt; 160      FALSE</span></span>
<span><span class="co">#&gt; 189      FALSE</span></span>
<span><span class="co">#&gt; 237      FALSE</span></span>
<span><span class="co">#&gt; 254      FALSE</span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level2">
<h2 id="saving-a-calibration_results-object">Saving a calibration_results object<a class="anchor" aria-label="anchor" href="#saving-a-calibration_results-object"></a>
</h2>
<p>After calibrating and selecting the best-performing models, we can
proceed to fit the final models (see the vignette for model exploration)
using the <code>calibration_results</code> object. As this object is
essentially a list, users can save it to a local directory using
<code><a href="https://rspatial.github.io/terra/reference/serialize.html" class="external-link">saveRDS()</a></code>. Saving the object facilitates loading it back
into your R session later using <code><a href="https://rspatial.github.io/terra/reference/serialize.html" class="external-link">readRDS()</a></code>. See an example
below:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set directory to save (here, in a temporary directory)</span></span>
<span><span class="va">dir_to_save</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save the data</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/serialize.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">m</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dir_to_save</span>, <span class="st">"Candidates.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Import data</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/serialize.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dir_to_save</span>, <span class="st">"Candidates.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marlon E. Cobos, Weverton Trindade, Luis F. Arias-Giraldo, Luis Osorio-Olvera, A. Townsend Peterson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
