<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Analysis of extrapolation risks in partitions using the MOP metric — explore_partition_extrapolation • kuenm2</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analysis of extrapolation risks in partitions using the MOP metric — explore_partition_extrapolation"><meta name="description" content="This function calculates environmental dissimilarities and identifies
non-analogous conditions by comparing the training data against the test data
for each partition, using the MOP (Mobility-Oriented Parity) metric."><meta property="og:description" content="This function calculates environmental dissimilarities and identifies
non-analogous conditions by comparing the training data against the test data
for each partition, using the MOP (Mobility-Oriented Parity) metric."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">kuenm2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.10</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/basic_data_cleaning.html">1. Occurrence Data Cleaning</a></li>
    <li><a class="dropdown-item" href="../articles/prepare_data.html">2. Prepare Data for Model Calibration</a></li>
    <li><a class="dropdown-item" href="../articles/model_calibration.html">3. Model Calibration</a></li>
    <li><a class="dropdown-item" href="../articles/model_exploration.html">4. Fit and Explore Selected Models</a></li>
    <li><a class="dropdown-item" href="../articles/model_predictions.html">5. Predict models to single scenario</a></li>
    <li><a class="dropdown-item" href="../articles/model_projections.html">6. Project models to multiple scenarios</a></li>
    <li><a class="dropdown-item" href="../articles/variability_and_uncertainty.html">7. Exploring Model Uncertainty and Variability</a></li>
    <li><a class="dropdown-item" href="../articles/organize_past_chelsa.html">8. Organize projections manually</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/marlonecobos/kuenm2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Analysis of extrapolation risks in partitions using the MOP metric</h1>
      <small class="dont-index">Source: <a href="https://github.com/marlonecobos/kuenm2/blob/main/R/explore_partition_extrapolation.R" class="external-link"><code>R/explore_partition_extrapolation.R</code></a></small>
      <div class="d-none name"><code>explore_partition_extrapolation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function calculates environmental dissimilarities and identifies
non-analogous conditions by comparing the training data against the test data
for each partition, using the MOP (Mobility-Oriented Parity) metric.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">explore_partition_extrapolation</span><span class="op">(</span><span class="va">data</span>, include_train_background <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                       include_test_background <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                       variables <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                                       mop_type <span class="op">=</span> <span class="st">"detailed"</span>,</span>
<span>                                       calculate_distance <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                       where_distance <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>                                       return_raster_result <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                       raster_variables <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                                       progress_bar <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>an object of class <code>prepared_data</code> returned by the
<code><a href="prepare_data.html">prepare_data()</a></code> function.</p></dd>


<dt id="arg-include-train-background">include_train_background<a class="anchor" aria-label="anchor" href="#arg-include-train-background"></a></dt>
<dd><p>(logical) whether to include the background
points used in training to define the environmental range of the training
data. If set to FALSE, only the environmental conditions of the training
presence records will be considered. Default is TRUE, meaning both presence
and background points are used.</p></dd>


<dt id="arg-include-test-background">include_test_background<a class="anchor" aria-label="anchor" href="#arg-include-test-background"></a></dt>
<dd><p>(logical) whether to compute MOP for both the
test presence records and the background points not used during training.
Default is FALSE, meaning MOP will be calculated only for the test presences.</p></dd>


<dt id="arg-variables">variables<a class="anchor" aria-label="anchor" href="#arg-variables"></a></dt>
<dd><p>(character) names of the variables to be used in the MOP
calculation. Default is NULL, meaning all variables in <code>data</code> will be used.</p></dd>


<dt id="arg-mop-type">mop_type<a class="anchor" aria-label="anchor" href="#arg-mop-type"></a></dt>
<dd><p>(character) type of MOP analysis to be performed. Options
available are "basic", "simple" and "detailed". Default is 'simples'. See
<code><a href="projection_mop.html">projection_mop</a></code>() for more details.</p></dd>


<dt id="arg-calculate-distance">calculate_distance<a class="anchor" aria-label="anchor" href="#arg-calculate-distance"></a></dt>
<dd><p>(logical) whether to calculate distances
(dissimilarities) between train and test data. Default is TRUE.</p></dd>


<dt id="arg-where-distance">where_distance<a class="anchor" aria-label="anchor" href="#arg-where-distance"></a></dt>
<dd><p>(character) specifies which values in train data should
be used to calculate distances. Options are: "in_range" (only conditions
within the train range), "out_range" (only conditions outside the
train range), and "all" (all conditions). Default is "all".</p></dd>


<dt id="arg-return-raster-result">return_raster_result<a class="anchor" aria-label="anchor" href="#arg-return-raster-result"></a></dt>
<dd><p>(logical) whether to return a <code>SpatRaster</code>
showing the spatial distribution of test data that falls within and outside
the range of the training data. Default is TRUE.</p></dd>


<dt id="arg-raster-variables">raster_variables<a class="anchor" aria-label="anchor" href="#arg-raster-variables"></a></dt>
<dd><p>a <code>SpatRaster</code> object representing the predictor
variables used to calibrate the models. Preferably the same object used in
<code>prepare_data</code>. Only used if <code>return_raster_result = TRUE</code>.</p></dd>


<dt id="arg-progress-bar">progress_bar<a class="anchor" aria-label="anchor" href="#arg-progress-bar"></a></dt>
<dd><p>(logical) whether to display a progress bar during
processing. Default is FALSE.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments passed to <code><a href="https://rdrr.io/pkg/mop/man/mop.html" class="external-link">mop</a>()</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>data.frame</code> containing:</p><ul><li><p>MOP distances (if <code>calculate_distance = TRUE</code>);</p></li>
<li><p>an indicator of whether environmental conditions at each test record fall
within the training range;</p></li>
<li><p>the number of variables outside the training range;</p></li>
<li><p>the names of variables with values lower or higher than the training range;</p></li>
<li><p>if the <code>prepared_data</code> object includes categorical variables, it will also
contain columns indicating which values in the testing data were not present
in the training data.</p></li>
</ul><p>If <code>return_raster_result = TRUE</code>, it also returns a <code>SpatRaster</code> showing the
spatial distribution of test data that falls within and outside the range of
the training data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#Prepare data</span></span></span>
<span class="r-in"><span><span class="co"># Import occurrences</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">occ_data</span>, package <span class="op">=</span> <span class="st">"kuenm2"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Import raster layers</span></span></span>
<span class="r-in"><span><span class="va">var</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Current_variables.tif"</span>,</span></span>
<span class="r-in"><span>                               package <span class="op">=</span> <span class="st">"kuenm2"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Prepare data for maxnet model</span></span></span>
<span class="r-in"><span><span class="va">sp_swd</span> <span class="op">&lt;-</span> <span class="fu"><a href="prepare_data.html">prepare_data</a></span><span class="op">(</span>algorithm <span class="op">=</span> <span class="st">"maxnet"</span>, occ <span class="op">=</span> <span class="va">occ_data</span>,</span></span>
<span class="r-in"><span>                       x <span class="op">=</span> <span class="st">"x"</span>, y <span class="op">=</span> <span class="st">"y"</span>,</span></span>
<span class="r-in"><span>                       raster_variables <span class="op">=</span> <span class="va">var</span>,</span></span>
<span class="r-in"><span>                       species <span class="op">=</span> <span class="va">occ_data</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                       n_background <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>                       categorical_variables <span class="op">=</span> <span class="st">"SoilType"</span>,</span></span>
<span class="r-in"><span>                       features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"lq"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       r_multiplier <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                       partition_method <span class="op">=</span> <span class="st">"kfolds"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>3 rows were excluded from database because NAs were found.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Analysis of extrapolation risks in partitions</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">explore_partition_extrapolation</span><span class="op">(</span>data <span class="op">=</span> <span class="va">sp_swd</span>,</span></span>
<span class="r-in"><span>                                       raster_variables <span class="op">=</span> <span class="va">var</span>,</span></span>
<span class="r-in"><span>                                       include_test_background <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#Plot spatial spatial distribution of test data</span></span></span>
<span class="r-in"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">Spatial_results</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="explore_partition_extrapolation-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Weverton C. F. Trindade, Luis F. Arias-Giraldo, Luis Osorio-Olvera, A. Townsend Peterson, Marlon E. Cobos.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

