<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Detect concave curves in GLM and GLMNET models — detect_concave • kuenm2</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Detect concave curves in GLM and GLMNET models — detect_concave"><meta name="description" content="Identifies the presence of concave response curves within the calibration
range of GLM and GLMNET models."><meta property="og:description" content="Identifies the presence of concave response curves within the calibration
range of GLM and GLMNET models."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">kuenm2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.10</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/basic_data_cleaning.html">1. Occurrence Data Cleaning</a></li>
    <li><a class="dropdown-item" href="../articles/prepare_data.html">2. Prepare Data for Model Calibration</a></li>
    <li><a class="dropdown-item" href="../articles/model_calibration.html">3. Model Calibration</a></li>
    <li><a class="dropdown-item" href="../articles/model_exploration.html">4. Fit and Explore Selected Models</a></li>
    <li><a class="dropdown-item" href="../articles/model_predictions.html">5. Predict models to single scenario</a></li>
    <li><a class="dropdown-item" href="../articles/model_projections.html">6. Project models to multiple scenarios</a></li>
    <li><a class="dropdown-item" href="../articles/variability_and_uncertainty.html">7. Exploring Model Uncertainty and Variability</a></li>
    <li><a class="dropdown-item" href="../articles/organize_past_chelsa.html">8. Organize projections manually</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/marlonecobos/kuenm2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Detect concave curves in GLM and GLMNET models</h1>
      <small class="dont-index">Source: <a href="https://github.com/marlonecobos/kuenm2/blob/main/R/detect_concave.R" class="external-link"><code>R/detect_concave.R</code></a></small>
      <div class="d-none name"><code>detect_concave.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Identifies the presence of concave response curves within the calibration
range of GLM and GLMNET models.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">detect_concave</span><span class="op">(</span><span class="va">model</span>, <span class="va">calib_data</span>, extrapolation_factor <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>               averages_from <span class="op">=</span> <span class="st">"pr"</span>, var_limits <span class="op">=</span> <span class="cn">NULL</span>, plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               mfrow <span class="op">=</span> <span class="cn">NULL</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>an object of class <code>glmnet_mx</code> or <code>glm</code>.</p></dd>


<dt id="arg-calib-data">calib_data<a class="anchor" aria-label="anchor" href="#arg-calib-data"></a></dt>
<dd><p>data.frame or matrix of data used for model calibration.</p></dd>


<dt id="arg-extrapolation-factor">extrapolation_factor<a class="anchor" aria-label="anchor" href="#arg-extrapolation-factor"></a></dt>
<dd><p>(numeric) a multiplier used to calculate the
extrapolation range. Larger values allow broader extrapolation beyond the
observed data range. Default is 0.1.</p></dd>


<dt id="arg-averages-from">averages_from<a class="anchor" aria-label="anchor" href="#arg-averages-from"></a></dt>
<dd><p>(character) specifies how the averages or modes of the
variables are calculated. Available options are "pr" (to calculate averages
from the presence localities) or "pr_bg" (to use the combined set of presence
and background localities). Default is "pr". See details.</p></dd>


<dt id="arg-var-limits">var_limits<a class="anchor" aria-label="anchor" href="#arg-var-limits"></a></dt>
<dd><p>(list) A named list specifying the lower and/or upper limits
for some variables. The first value represents the lower limit, and the
second value represents the upper limit. Default is <code>NULL</code>, meaning no
specific limits are applied, and the range will be calculated using the
<code>extrapolation_factor</code>. See details.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>(logical) whether to plot the response curve for the variables.
Default is FALSE.</p></dd>


<dt id="arg-mfrow">mfrow<a class="anchor" aria-label="anchor" href="#arg-mfrow"></a></dt>
<dd><p>(numeric) a vector of the form c(number of rows, number of columns)
specifying the layout of plots. Default is c(1, 1), meaning one plot per window.</p></dd>


<dt id="arg-legend">legend<a class="anchor" aria-label="anchor" href="#arg-legend"></a></dt>
<dd><p>(logical) whether to include a legend in the plot. The legend
indicates whether the response curve is convex, concave outside the range
limits, or concave within the range limits. Default is FALSE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the following elements for each variable:</p><ul><li><p>is_concave (logical): indicates whether the response curve for the variable
is concave within the limit range. This occurs when the quadratic term's
coefficient is positive and the vertex lies between x_min and x_max,</p></li>
<li><p>vertex (numeric): the vertex of the parabola, representing the point where
the curve changes direction.</p></li>
<li><p>b2 (numeric): the coefficient of the quadratic term for the variable.
Positive values indicate a concave curve.</p></li>
<li><p>x_min and x_max (numeric): the range limits to identify concave curves,
calculated as the observed data range multiplied by the extrapolation
factor.</p></li>
<li><p>real_x_min and real_x_max (numeric) the actual range of the data,
excluding the extrapolation factor.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Concave curves are identified by analyzing the beta coefficients of quadratic
terms within the variable's range. The range for extrapolation is calculated
as the difference between the variable's maximum and minimum values in the
model, multiplied by the extrapolation factor. A concave curve is detected
when the beta coefficient is positive, and the vertex — where the curve
changes direction — lies between the lower and upper limits of the variable.</p>
<p>Users can specify the lower and upper limits for certain variables using
<code>var_limits</code>. For example, if <code>var_limits = list("bio12" = c(0, NA),
"bio15" = c(0, 100))</code>, the lower limit for <code>bio12</code> will be 0, and the
upper limit will be calculated using the extrapolation factor. Similarly,
the lower and upper limits for <code>bio15</code> will be 0 and 100, respectively.</p>
<p>For calculating the vertex position, a response curve for a given variable is
generated with all other variables set to their mean values (or mode for
categorical variables). These values are calculated either from the presence
localities (if <code>averages_from = "pr"</code>) or from the combined set of
presence and background localities (if <code>averages_from = "pr_bg"</code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Import example of a fitted_model (output of fit_selected()) that have</span></span></span>
<span class="r-in"><span><span class="co"># concave curves</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"fitted_model_concave"</span>, package <span class="op">=</span> <span class="st">"kuenm2"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Response curves</span></span></span>
<span class="r-in"><span><span class="va">ccurves</span> <span class="op">&lt;-</span> <span class="fu">detect_concave</span><span class="op">(</span>model <span class="op">=</span> <span class="va">fitted_model_concave</span><span class="op">$</span><span class="va">Models</span><span class="op">$</span><span class="va">Model_798</span><span class="op">$</span><span class="va">Full_model</span>,</span></span>
<span class="r-in"><span>                          calib_data <span class="op">=</span> <span class="va">fitted_model_concave</span><span class="op">$</span><span class="va">calibration_data</span>,</span></span>
<span class="r-in"><span>                          extrapolation_factor <span class="op">=</span> <span class="fl">0.2</span>,</span></span>
<span class="r-in"><span>                          var_limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"bio_2"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                            <span class="st">"sand"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                            <span class="st">"clay"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          plot <span class="op">=</span> <span class="cn">TRUE</span>, mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="detect_concave-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Weverton C. F. Trindade, Luis F. Arias-Giraldo, Luis Osorio-Olvera, A. Townsend Peterson, Marlon E. Cobos.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

