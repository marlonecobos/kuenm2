<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Detect concave curves in GLM and GLMNET models — detect_concave • kuenm2</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Detect concave curves in GLM and GLMNET models — detect_concave"><meta property="og:description" content="Identifies the presence of concave response curves within the calibration
range of GLM and GLMNET models."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">kuenm2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>

  </a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-book"></span>

    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/basic_bata_cleaning.html">1. Occurrence Data Cleaning</a>
    </li>
    <li>
      <a href="../articles/prepare_data.html">2. Prepare Data for Model Calibration</a>
    </li>
    <li>
      <a href="../articles/model_calibration.html">3. Model Calibration</a>
    </li>
    <li>
      <a href="../articles/model_exploration.html">4. Fit and Explore Selected Models</a>
    </li>
    <li>
      <a href="../articles/model_predictions.html">5. Predict models to single scenario</a>
    </li>
    <li>
      <a href="../articles/model_projections.html">6. Project models to multiple scenarios</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Detect concave curves in GLM and GLMNET models</h1>

    <div class="hidden name"><code>detect_concave.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Identifies the presence of concave response curves within the calibration
range of GLM and GLMNET models.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">detect_concave</span><span class="op">(</span><span class="va">model</span>, <span class="va">calib_data</span>, extrapolation_factor <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>               averages_from <span class="op">=</span> <span class="st">"pr"</span>, var_limits <span class="op">=</span> <span class="cn">NULL</span>, plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               mfrow <span class="op">=</span> <span class="cn">NULL</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>an object of class <code>glmnet_mx</code> or <code>glm</code>.</p></dd>


<dt id="arg-calib-data">calib_data<a class="anchor" aria-label="anchor" href="#arg-calib-data"></a></dt>
<dd><p>data.frame or matrix of data used for model calibration.</p></dd>


<dt id="arg-extrapolation-factor">extrapolation_factor<a class="anchor" aria-label="anchor" href="#arg-extrapolation-factor"></a></dt>
<dd><p>(numeric) a multiplier used to calculate the
extrapolation range. Larger values allow broader extrapolation beyond the
observed data range. Default is 0.1.</p></dd>


<dt id="arg-averages-from">averages_from<a class="anchor" aria-label="anchor" href="#arg-averages-from"></a></dt>
<dd><p>(character) specifies how the averages or modes of the
variables are calculated. Available options are "pr" (to calculate averages
from the presence localities) or "pr_bg" (to use the combined set of presence
and background localities). Default is "pr". See details.</p></dd>


<dt id="arg-var-limits">var_limits<a class="anchor" aria-label="anchor" href="#arg-var-limits"></a></dt>
<dd><p>(list) A named list specifying the lower and/or upper limits
for some variables. The first value represents the lower limit, and the
second value represents the upper limit. Default is <code>NULL</code>, meaning no
specific limits are applied, and the range will be calculated using the
<code>extrapolation_factor</code>. See details.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>(logical) whether to plot the response curve for the variables.
Default is FALSE.</p></dd>


<dt id="arg-mfrow">mfrow<a class="anchor" aria-label="anchor" href="#arg-mfrow"></a></dt>
<dd><p>(numeric) a vector of the form c(number of rows, number of columns)
specifying the layout of plots. Default is c(1, 1), meaning one plot per window.</p></dd>


<dt id="arg-legend">legend<a class="anchor" aria-label="anchor" href="#arg-legend"></a></dt>
<dd><p>(logical) whether to include a legend in the plot. The legend
indicates whether the response curve is convex, concave outside the range
limits, or concave within the range limits. Default is FALSE.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list with the following elements for each variable:</p><ul><li><p>is_concave (logical): indicates whether the response curve for the variable
is concave within the limit range. This occurs when the quadratic term's
coefficient is positive and the vertex lies between x_min and x_max,</p></li>
<li><p>vertex (numeric): the vertex of the parabola, representing the point where
the curve changes direction.</p></li>
<li><p>b2 (numeric): the coefficient of the quadratic term for the variable.
Positive values indicate a concave curve.</p></li>
<li><p>x_min and x_max (numeric): the range limits to identify concave curves,
calculated as the observed data range multiplied by the extrapolation
factor.</p></li>
<li><p>real_x_min and real_x_max (numeric) the actual range of the data,
excluding the extrapolation factor.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>Concave curves are identified by analyzing the beta coefficients of quadratic
terms within the variable's range. The range for extrapolation is calculated
as the difference between the variable's maximum and minimum values in the
model, multiplied by the extrapolation factor. A concave curve is detected
when the beta coefficient is positive, and the vertex — where the curve
changes direction — lies between the lower and upper limits of the variable.</p>
<p>Users can specify the lower and upper limits for certain variables using
<code>var_limits</code>. For example, if <code>var_limits = list("bio12" = c(0, NA),
"bio15" = c(0, 100))</code>, the lower limit for <code>bio12</code> will be 0, and the
upper limit will be calculated using the extrapolation factor. Similarly,
the lower and upper limits for <code>bio15</code> will be 0 and 100, respectively.</p>
<p>For calculating the vertex position, a response curve for a given variable is
generated with all other variables set to their mean values (or mode for
categorical variables). These values are calculated either from the presence
localities (if <code>averages_from = "pr"</code>) or from the combined set of
presence and background localities (if <code>averages_from = "pr_bg"</code>).</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Import example of a fitted_model (output of fit_selected()) that have</span></span></span>
<span class="r-in"><span><span class="co"># concave curves</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"fitted_model_concave"</span>, package <span class="op">=</span> <span class="st">"kuenm2"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Response curves</span></span></span>
<span class="r-in"><span><span class="va">ccurves</span> <span class="op">&lt;-</span> <span class="fu">detect_concave</span><span class="op">(</span>model <span class="op">=</span> <span class="va">fitted_model_concave</span><span class="op">$</span><span class="va">Models</span><span class="op">$</span><span class="va">Model_798</span><span class="op">$</span><span class="va">Full_model</span>,</span></span>
<span class="r-in"><span>                          calib_data <span class="op">=</span> <span class="va">fitted_model_concave</span><span class="op">$</span><span class="va">calibration_data</span>,</span></span>
<span class="r-in"><span>                          extrapolation_factor <span class="op">=</span> <span class="fl">0.2</span>,</span></span>
<span class="r-in"><span>                          var_limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"bio_2"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                            <span class="st">"sand"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                            <span class="st">"clay"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          plot <span class="op">=</span> <span class="cn">TRUE</span>, mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="detect_concave-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Marlon E. Cobos, Weverton Trindade, Luis F. Arias-Giraldo, Luis Osorio-Olvera, A. Townsend Peterson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

