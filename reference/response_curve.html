<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Variable response curves for fitted models — response_curve • kuenm2</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Variable response curves for fitted models — response_curve"><meta name="description" content="Plot variable responses for fitted models. Responses based on single or
multiple models can be plotted."><meta property="og:description" content="Plot variable responses for fitted models. Responses based on single or
multiple models can be plotted."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">kuenm2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.11</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/basic_data_cleaning.html">1. Basic Data Cleaning</a></li>
    <li><a class="dropdown-item" href="../articles/prepare_data.html">2. Prepare Data for Model Calibration</a></li>
    <li><a class="dropdown-item" href="../articles/model_calibration.html">3. Model Calibration</a></li>
    <li><a class="dropdown-item" href="../articles/model_exploration.html">4. Fit and Explore Selected Models</a></li>
    <li><a class="dropdown-item" href="../articles/model_predictions.html">5. Project Models to a Single Scenario</a></li>
    <li><a class="dropdown-item" href="../articles/model_projections.html">6. Project Models to Multiple Scenarios</a></li>
    <li><a class="dropdown-item" href="../articles/variability_and_uncertainty.html">7. Exploring Model Uncertainty and Variability</a></li>
    <li><a class="dropdown-item" href="../articles/projections_chelsa.html">8. Example of Projections Using CHELSA Data</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/marlonecobos/kuenm2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Variable response curves for fitted models</h1>
      <small class="dont-index">Source: <a href="https://github.com/marlonecobos/kuenm2/blob/main/R/response_curves.R" class="external-link"><code>R/response_curves.R</code></a></small>
      <div class="d-none name"><code>response_curve.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plot variable responses for fitted models. Responses based on single or
multiple models can be plotted.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># Single variable response curves</span></span>
<span><span class="fu">response_curve</span><span class="op">(</span><span class="va">models</span>, <span class="va">variable</span>, modelID <span class="op">=</span> <span class="cn">NULL</span>, n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>               show_variability <span class="op">=</span> <span class="cn">FALSE</span>, show_lines <span class="op">=</span> <span class="cn">FALSE</span>, data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               new_data <span class="op">=</span> <span class="cn">NULL</span>, averages_from <span class="op">=</span> <span class="st">"pr_bg"</span>, extrapolate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               extrapolation_factor <span class="op">=</span> <span class="fl">0.1</span>, add_points <span class="op">=</span> <span class="cn">FALSE</span>, p_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               l_limit <span class="op">=</span> <span class="cn">NULL</span>, u_limit <span class="op">=</span> <span class="cn">NULL</span>, xlab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               ylab <span class="op">=</span> <span class="st">"Suitability"</span>, col <span class="op">=</span> <span class="st">"darkblue"</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Response curves for all variables in all or individual models</span></span>
<span><span class="fu">all_response_curves</span><span class="op">(</span><span class="va">models</span>, modelID <span class="op">=</span> <span class="cn">NULL</span>, n <span class="op">=</span> <span class="fl">100</span>, show_variability <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                    show_lines <span class="op">=</span> <span class="cn">FALSE</span>, data <span class="op">=</span> <span class="cn">NULL</span>, new_data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                    averages_from <span class="op">=</span> <span class="st">"pr_bg"</span>, extrapolate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    extrapolation_factor <span class="op">=</span> <span class="fl">0.1</span>, add_points <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                    p_col <span class="op">=</span> <span class="cn">NULL</span>, l_limit <span class="op">=</span> <span class="cn">NULL</span>, u_limit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                    xlab <span class="op">=</span> <span class="cn">NULL</span>, ylab <span class="op">=</span> <span class="st">"Suitability"</span>, col <span class="op">=</span> <span class="st">"darkblue"</span>,</span>
<span>                    ylim <span class="op">=</span> <span class="cn">NULL</span>, mfrow <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-models">models<a class="anchor" aria-label="anchor" href="#arg-models"></a></dt>
<dd><p>an object of class <code>fitted_models</code> returned by the
<code><a href="fit_selected.html">fit_selected()</a></code> function.</p></dd>


<dt id="arg-variable">variable<a class="anchor" aria-label="anchor" href="#arg-variable"></a></dt>
<dd><p>(character) name of the variable to be plotted.</p></dd>


<dt id="arg-modelid">modelID<a class="anchor" aria-label="anchor" href="#arg-modelid"></a></dt>
<dd><p>(character) ModelID(s) to be considered. By default all IDs
in <code>models</code> are included. Default = NULL.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>(numeric) an integer guiding the number of breaks to produce the
curve. Default = 100.</p></dd>


<dt id="arg-show-variability">show_variability<a class="anchor" aria-label="anchor" href="#arg-show-variability"></a></dt>
<dd><p>(logical) if <code>modelID</code> is defined, shows variability
in response curves considering replicates. If <code>modelID</code> is not defined, the
default, FALSE, always shows variability from multiple models if present in
<code>models</code>.</p></dd>


<dt id="arg-show-lines">show_lines<a class="anchor" aria-label="anchor" href="#arg-show-lines"></a></dt>
<dd><p>(logical) whether to show variability by plotting lines for
all models or replicates. The default = FALSE, uses a GAM to characterize a
median trend and variation among modes or replicates. Ignored if
<code>show_variability</code> = FALSE and <code>modelID</code> is defined.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>data.frame or matrix of data used in the model calibration step.
The default, NULL, uses data stored in <code>models</code>.</p></dd>


<dt id="arg-new-data">new_data<a class="anchor" aria-label="anchor" href="#arg-new-data"></a></dt>
<dd><p>a <code>SpatRaster</code>, data.frame, or  matrix with values for
variables representing an area or scenario of interest for model projection.
Default = NULL.</p></dd>


<dt id="arg-averages-from">averages_from<a class="anchor" aria-label="anchor" href="#arg-averages-from"></a></dt>
<dd><p>(character) specifies how the averages or modes of the
other variables are calculated when producing responses for the variable of
interest. Options are "pr" (from the presences) or "pr_bg" (from presences
and background). Default is "pr_bg". See details.</p></dd>


<dt id="arg-extrapolate">extrapolate<a class="anchor" aria-label="anchor" href="#arg-extrapolate"></a></dt>
<dd><p>(logical) whether to allow extrapolation of the response
outside training conditions. Ignored if <code>new_data</code> is defined. Default = TRUE.</p></dd>


<dt id="arg-extrapolation-factor">extrapolation_factor<a class="anchor" aria-label="anchor" href="#arg-extrapolation-factor"></a></dt>
<dd><p>(numeric) a value used to calculate how much to
expand the training region for extrapolation. Larger values produce
extrapolation farther from training limits. Default = 0.1.</p></dd>


<dt id="arg-add-points">add_points<a class="anchor" aria-label="anchor" href="#arg-add-points"></a></dt>
<dd><p>(logical) if <code>TRUE</code>, adds the original observed
points (0/1) to the plot. This also sets <code>ylim = c(0, 1)</code>, unless these
limits are defined as part of <code>...</code>. Default = <code>FALSE</code>.</p></dd>


<dt id="arg-p-col">p_col<a class="anchor" aria-label="anchor" href="#arg-p-col"></a></dt>
<dd><p>(character) color for the observed points when
<code>add_points = TRUE</code>. Any valid R color name or hexadecimal code.
Default = "black".</p></dd>


<dt id="arg-l-limit">l_limit<a class="anchor" aria-label="anchor" href="#arg-l-limit"></a></dt>
<dd><p>(numeric) directly specifies the lower limit for the variable.
Default = NULL, meaning the lower limit will be calculated from existing data.
(if <code>extrapolation = TRUE</code>).</p></dd>


<dt id="arg-u-limit">u_limit<a class="anchor" aria-label="anchor" href="#arg-u-limit"></a></dt>
<dd><p>(numeric) directly specifies the upper limit for the variable.
Default = NULL, meaning the aupper limit will be calculated from existing data.
(if <code>extrapolation = TRUE</code>).</p></dd>


<dt id="arg-xlab">xlab<a class="anchor" aria-label="anchor" href="#arg-xlab"></a></dt>
<dd><p>(character) a label for the x axis. The default, NULL, uses the
name defined in <code>variable</code>.</p></dd>


<dt id="arg-ylab">ylab<a class="anchor" aria-label="anchor" href="#arg-ylab"></a></dt>
<dd><p>(character) a label for the y axis. Default = "Suitability".</p></dd>


<dt id="arg-col">col<a class="anchor" aria-label="anchor" href="#arg-col"></a></dt>
<dd><p>(character) color for lines. Default = "darkblue".</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments passed to <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></code>.</p></dd>


<dt id="arg-ylim">ylim<a class="anchor" aria-label="anchor" href="#arg-ylim"></a></dt>
<dd><p>(numeric) vector of length two with limits for the y axis.
Directly used in <code>all_response_curves</code>. Default = NULL.</p></dd>


<dt id="arg-mfrow">mfrow<a class="anchor" aria-label="anchor" href="#arg-mfrow"></a></dt>
<dd><p>(numeric) a vector specifying the number of rows and columns in
the plot layout, e.g., c(rows, columns). Default is NULL, meaning
the grid will be arranged automatically based on the number of plots.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>For response_curve(), a plot with the response curve for a <code>variable</code>. For
all_response_curves(), a multipanel plot with response curves fro all
variables in <code>models</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The response curve for a variable of interest is generated with all other
variables set to their mean values (or mode for categorical variables),
calculated either from the presence records (if averages_from = "pr") or
the combined set of presence and background records (if averages_from =
"pr_bg").</p>
<p>For categorical variables, a bar plot is generated with error bars showing
variability across models (if multiple models are included).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="bivariate_response.html">bivariate_response()</a></code>, <code><a href="partition_response_curves.html">partition_response_curves()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example with maxnet</span></span></span>
<span class="r-in"><span><span class="co"># Import example of fitted_models (output of fit_selected())</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">fitted_model_maxnet</span>, package <span class="op">=</span> <span class="st">"kuenm2"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Response curves for one variable at a time</span></span></span>
<span class="r-in"><span><span class="fu">response_curve</span><span class="op">(</span>models <span class="op">=</span> <span class="va">fitted_model_maxnet</span>, variable <span class="op">=</span> <span class="st">"bio_1"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="response_curve-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">response_curve</span><span class="op">(</span>models <span class="op">=</span> <span class="va">fitted_model_maxnet</span>, variable <span class="op">=</span> <span class="st">"bio_1"</span>,</span></span>
<span class="r-in"><span>               add_points <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="response_curve-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">response_curve</span><span class="op">(</span>models <span class="op">=</span> <span class="va">fitted_model_maxnet</span>, variable <span class="op">=</span> <span class="st">"bio_1"</span>,</span></span>
<span class="r-in"><span>               show_lines <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="response_curve-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">response_curve</span><span class="op">(</span>models <span class="op">=</span> <span class="va">fitted_model_maxnet</span>, variable <span class="op">=</span> <span class="st">"bio_1"</span>,</span></span>
<span class="r-in"><span>               modelID <span class="op">=</span> <span class="st">"Model_192"</span>, show_variability <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="response_curve-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">response_curve</span><span class="op">(</span>models <span class="op">=</span> <span class="va">fitted_model_maxnet</span>, variable <span class="op">=</span> <span class="st">"bio_1"</span>,</span></span>
<span class="r-in"><span>               modelID <span class="op">=</span> <span class="st">"Model_192"</span>, show_variability <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>               show_lines <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="response_curve-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example with maxnet</span></span></span>
<span class="r-in"><span><span class="co"># Import example of fitted_models (output of fit_selected())</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">fitted_model_maxnet</span>, package <span class="op">=</span> <span class="st">"kuenm2"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Response curves for all variables at once</span></span></span>
<span class="r-in"><span><span class="fu">all_response_curves</span><span class="op">(</span><span class="va">fitted_model_maxnet</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="response_curve-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">all_response_curves</span><span class="op">(</span><span class="va">fitted_model_maxnet</span>, show_lines <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="response_curve-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">all_response_curves</span><span class="op">(</span><span class="va">fitted_model_maxnet</span>, show_lines <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                    add_points <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="response_curve-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">all_response_curves</span><span class="op">(</span><span class="va">fitted_model_maxnet</span>, modelID <span class="op">=</span> <span class="st">"Model_192"</span>,</span></span>
<span class="r-in"><span>                    show_variability <span class="op">=</span> <span class="cn">TRUE</span>, show_lines <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="response_curve-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">all_response_curves</span><span class="op">(</span><span class="va">fitted_model_maxnet</span>, modelID <span class="op">=</span> <span class="st">"Model_192"</span>,</span></span>
<span class="r-in"><span>                    show_variability <span class="op">=</span> <span class="cn">TRUE</span>, show_lines <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                    add_points <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="response_curve-10.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Weverton C. F. Trindade, Luis F. Arias-Giraldo, Luis Osorio-Olvera, A. Townsend Peterson, Marlon E. Cobos.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

