<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Principal Component Analysis for raster layers — perform_pca • kuenm2</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Principal Component Analysis for raster layers — perform_pca"><meta property="og:description" content="This function performs principal component analysis (PCA) with a set of
raster variables."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">kuenm2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>

  </a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-book"></span>

    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/basic_bata_cleaning.html">1. Occurrence Data Cleaning</a>
    </li>
    <li>
      <a href="../articles/prepare_data.html">2. Prepare Data for Model Calibration</a>
    </li>
    <li>
      <a href="../articles/model_calibration.html">3. Model Calibration</a>
    </li>
    <li>
      <a href="../articles/model_exploration.html">4. Fit and Explore Selected Models</a>
    </li>
    <li>
      <a href="../articles/model_predictions.html">5. Predict models to single scenario</a>
    </li>
    <li>
      <a href="../articles/model_projections.html">6. Project models to multiple scenarios</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Principal Component Analysis for raster layers</h1>

    <div class="hidden name"><code>perform_pca.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function performs principal component analysis (PCA) with a set of
raster variables.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">perform_pca</span><span class="op">(</span><span class="va">raster_variables</span>, exclude_from_pca <span class="op">=</span> <span class="cn">NULL</span>, project <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>            projection_data <span class="op">=</span> <span class="cn">NULL</span>, out_dir <span class="op">=</span> <span class="cn">NULL</span>, overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>            progress_bar <span class="op">=</span> <span class="cn">FALSE</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>            variance_explained <span class="op">=</span> <span class="fl">95</span>, min_explained <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-raster-variables">raster_variables<a class="anchor" aria-label="anchor" href="#arg-raster-variables"></a></dt>
<dd><p>(SpatRaster) set of predictor variables that the
function will summarize into a set of orthogonal, uncorrelated
components based on PCA.</p></dd>


<dt id="arg-exclude-from-pca">exclude_from_pca<a class="anchor" aria-label="anchor" href="#arg-exclude-from-pca"></a></dt>
<dd><p>(character) variable names within raster_variables that
should not be included in the PCA transformation. Instead, these
variables will be added directly to the final set of output variables
without being modified. The default is NULL, meaning all variables
will be used unless specified otherwise.</p></dd>


<dt id="arg-project">project<a class="anchor" aria-label="anchor" href="#arg-project"></a></dt>
<dd><p>(logical) whether the function should project new data from
different scenarios (e.g. future variables) onto the PCA coordinates
generated by the initial analysis. If TRUE, the argument
projection_data needs to be defined. Default is FALSE.</p></dd>


<dt id="arg-projection-data">projection_data<a class="anchor" aria-label="anchor" href="#arg-projection-data"></a></dt>
<dd><p>an object of class <code>prepared_projection</code> returned by the
<code><a href="prepare_projection.html">prepare_projection()</a></code> function. This file contains the paths
to the raster files representing each scenario. Only applicable if
<code>project = TRUE</code>. Default is NULL.</p></dd>


<dt id="arg-out-dir">out_dir<a class="anchor" aria-label="anchor" href="#arg-out-dir"></a></dt>
<dd><p>(character) a path to a root directory for saving the raster
files of each projection. Default = NULL.</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>(logical) whether to overwrite SpatRaster if they already
exists when projecting. Only applicable if <code>write_files</code> is set to
TRUE. Default is FALSE.</p></dd>


<dt id="arg-progress-bar">progress_bar<a class="anchor" aria-label="anchor" href="#arg-progress-bar"></a></dt>
<dd><p>(logical) whether to display a progress bar during
processing projections. Only applicable if <code>project = TRUE</code>. Default
is FALSE</p></dd>


<dt id="arg-center">center<a class="anchor" aria-label="anchor" href="#arg-center"></a></dt>
<dd><p>(logical) whether the variables should be zero-centered.
Default is TRUE.</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>(logical) whether the variables should be scaled to have unit
variance before the analysis takes place. Default is FALSE.</p></dd>


<dt id="arg-variance-explained">variance_explained<a class="anchor" aria-label="anchor" href="#arg-variance-explained"></a></dt>
<dd><p>(numeric) the cumulative percentage of total
variance that must be explained by the selected principal components.
Default is 95.</p></dd>


<dt id="arg-min-explained">min_explained<a class="anchor" aria-label="anchor" href="#arg-min-explained"></a></dt>
<dd><p>(numeric) the minimum percentage of total variance that
a principal component must explain to be retained. Default is 5.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list containing the following elements:</p><ul><li><p>env: A SpatRaster object that contains the orthogonal components derived
from the PCA. PCs correspond to the variables used to perform the analysis.</p></li>
<li><p>pca: an object of class prcomp, containing the details of the PCA analysis.
See <code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></code>().</p></li>
<li><p>variance_explained_cum_sum: The cumulative percentage of total variance
explained by each of the selected principal components. This value indicates
how much of the data’s original variability is captured by the PCA
transformation.</p></li>
<li><p>projection_directory: the root directory where projection files were saved.
Not NULL only if <code>project</code> was set to TRUE. This directory contains the
projected raster files for each scenario.</p></li>
</ul></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># PCA with current variables</span></span></span>
<span class="r-in"><span><span class="co"># Import raster layers</span></span></span>
<span class="r-in"><span><span class="va">var</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Current_variables.tif"</span>,</span></span>
<span class="r-in"><span>                               package <span class="op">=</span> <span class="st">"kuenm2"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># PCA</span></span></span>
<span class="r-in"><span><span class="va">pca_var</span> <span class="op">&lt;-</span> <span class="fu">perform_pca</span><span class="op">(</span>raster_variables <span class="op">=</span> <span class="va">var</span>, exclude_from_pca <span class="op">=</span> <span class="st">"SoilType"</span>,</span></span>
<span class="r-in"><span>                       center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pca_var</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $env</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class       : SpatRaster </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> size        : 52, 40, 5  (nrow, ncol, nlyr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> resolution  : 0.1666667, 0.1666667  (x, y)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> extent      : -53.5, -46.83333, -30.83333, -22.16667  (xmin, xmax, ymin, ymax)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> coord. ref. : lon/lat WGS 84 (EPSG:4326) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sources     : memory  (4 layers) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Current_variables.tif  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> varnames    : Current_variables </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Current_variables </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> names       :       PC1,       PC2,       PC3,       PC4, SoilType </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> min values  : -3.621362, -2.041276, -3.923471, -1.730859,        1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> max values  :  2.929786,  3.029667,  1.752452,  1.601162,       23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pca</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard deviations (1, .., p=4):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.4574175 0.9290330 0.8020786 0.6078666</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rotation (n x k) = (4 x 4):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               PC1        PC2         PC3         PC4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bio_1  -0.5327531 -0.1500983 -0.66580466  0.50034864</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bio_7   0.3338164 -0.9359166 -0.09775690 -0.05541088</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bio_12  0.5032916  0.2775767 -0.73525490 -0.35923383</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bio_15 -0.5928223 -0.1564666 -0.08091963 -0.78583200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $variance_explained_cumsum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       PC1       PC2       PC3       PC4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  53.10165  74.67920  90.76246 100.00000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $projection_directory</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Project PCA for new scenarios (future)</span></span></span>
<span class="r-in"><span><span class="co"># First, organize and prepare future variables</span></span></span>
<span class="r-in"><span><span class="co"># Set the input directory containing the raw future climate variables</span></span></span>
<span class="r-in"><span><span class="co"># For this example, the data is located in the "inst/extdata" folder.</span></span></span>
<span class="r-in"><span><span class="va">in_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"kuenm2"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a "Future_raw" folder in a temporary directory and copy the variables.</span></span></span>
<span class="r-in"><span><span class="va">out_dir_future</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"Future_raw1"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Organize and rename the future climate data, structuring it by year and GCM.</span></span></span>
<span class="r-in"><span><span class="co"># The 'SoilType' variable will be appended as a static variable in each scenario.</span></span></span>
<span class="r-in"><span><span class="co"># The files will be renamed following the "bio_" format</span></span></span>
<span class="r-in"><span><span class="fu"><a href="organize_future_worldclim.html">organize_future_worldclim</a></span><span class="op">(</span>input_dir <span class="op">=</span> <span class="va">in_dir</span>, output_dir <span class="op">=</span> <span class="va">out_dir_future</span>,</span></span>
<span class="r-in"><span>                          name_format <span class="op">=</span> <span class="st">"bio_"</span>, fixed_variables <span class="op">=</span> <span class="va">var</span><span class="op">$</span><span class="va">SoilType</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=========                                                             |  12%  |                                                                              |==================                                                    |  25%  |                                                                              |==========================                                            |  38%  |                                                                              |===================================                                   |  50%  |                                                                              |============================================                          |  62%  |                                                                              |====================================================                  |  75%  |                                                                              |=============================================================         |  88%  |                                                                              |======================================================================| 100%</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Variables successfully organized in directory:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> /tmp/RtmpGZTuJv/Future_raw1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Prepare projections</span></span></span>
<span class="r-in"><span><span class="va">pr</span> <span class="op">&lt;-</span> <span class="fu"><a href="prepare_projection.html">prepare_projection</a></span><span class="op">(</span>variable_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bio_1"</span>, <span class="st">"bio_7"</span>, <span class="st">"bio_12"</span>,</span></span>
<span class="r-in"><span>                                            <span class="st">"bio_15"</span>, <span class="st">"SoilType"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         future_dir <span class="op">=</span> <span class="va">out_dir_future</span>,</span></span>
<span class="r-in"><span>                         future_period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2041-2060"</span>, <span class="st">"2081-2100"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         future_pscen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ssp126"</span>, <span class="st">"ssp585"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         future_gcm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ACCESS-CM2"</span>, <span class="st">"MIROC6"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         raster_pattern <span class="op">=</span> <span class="st">".tif*"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create folder to save projection results</span></span></span>
<span class="r-in"><span><span class="va">out_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"PCA_projections"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">out_dir</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform and project PCA for new scenarios (future)</span></span></span>
<span class="r-in"><span><span class="va">proj_pca</span> <span class="op">&lt;-</span> <span class="fu">perform_pca</span><span class="op">(</span>raster_variables <span class="op">=</span> <span class="va">var</span>, exclude_from_pca <span class="op">=</span> <span class="st">"SoilType"</span>,</span></span>
<span class="r-in"><span>                        project <span class="op">=</span> <span class="cn">TRUE</span>, projection_data <span class="op">=</span> <span class="va">pr</span>,</span></span>
<span class="r-in"><span>                        out_dir <span class="op">=</span> <span class="va">out_dir</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">proj_pca</span><span class="op">$</span><span class="va">projection_directory</span>  <span class="co"># Directory with projected PCA-variables</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/tmp/RtmpGZTuJv/PCA_projections"</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Marlon E. Cobos, Weverton Trindade, Luis F. Arias-Giraldo, Luis Osorio-Olvera, A. Townsend Peterson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

