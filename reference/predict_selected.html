<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Predict selected models for a single scenario — predict_selected • kuenm2</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Predict selected models for a single scenario — predict_selected"><meta name="description" content="This function predicts selected models for a single set of new data
using either maxnet or glm It provides options to save the
output and compute consensus results (mean, median, etc.) across
replicates and models."><meta property="og:description" content="This function predicts selected models for a single set of new data
using either maxnet or glm It provides options to save the
output and compute consensus results (mean, median, etc.) across
replicates and models."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">kuenm2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.11</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/basic_data_cleaning.html">1. Basic Data Cleaning</a></li>
    <li><a class="dropdown-item" href="../articles/prepare_data.html">2. Prepare Data for Model Calibration</a></li>
    <li><a class="dropdown-item" href="../articles/model_calibration.html">3. Model Calibration</a></li>
    <li><a class="dropdown-item" href="../articles/model_exploration.html">4. Fit and Explore Selected Models</a></li>
    <li><a class="dropdown-item" href="../articles/model_predictions.html">5. Project Models to a Single Scenario</a></li>
    <li><a class="dropdown-item" href="../articles/model_projections.html">6. Project Models to Multiple Scenarios</a></li>
    <li><a class="dropdown-item" href="../articles/variability_and_uncertainty.html">7. Exploring Model Uncertainty and Variability</a></li>
    <li><a class="dropdown-item" href="../articles/projections_chelsa.html">8. Example of Projections Using CHELSA Data</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/marlonecobos/kuenm2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Predict selected models for a single scenario</h1>
      <small class="dont-index">Source: <a href="https://github.com/marlonecobos/kuenm2/blob/main/R/predict_selected.R" class="external-link"><code>R/predict_selected.R</code></a></small>
      <div class="d-none name"><code>predict_selected.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function predicts selected models for a single set of new data
using either <code>maxnet</code> or <code>glm</code> It provides options to save the
output and compute consensus results (mean, median, etc.) across
replicates and models.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">predict_selected</span><span class="op">(</span><span class="va">models</span>, <span class="va">new_variables</span>, mask <span class="op">=</span> <span class="cn">NULL</span>, write_files <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 write_replicates <span class="op">=</span> <span class="cn">FALSE</span>, out_dir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                 consensus_per_model <span class="op">=</span> <span class="cn">TRUE</span>, consensus_general <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 consensus <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"median"</span>, <span class="st">"range"</span>, <span class="st">"mean"</span>, <span class="st">"stdev"</span><span class="op">)</span>,</span>
<span>                 extrapolation_type <span class="op">=</span> <span class="st">"E"</span>, var_to_clamp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                 type <span class="op">=</span> <span class="st">"cloglog"</span>, overwrite <span class="op">=</span> <span class="cn">FALSE</span>, progress_bar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-models">models<a class="anchor" aria-label="anchor" href="#arg-models"></a></dt>
<dd><p>an object of class <code>fitted_models</code> returned by the
<code><a href="fit_selected.html">fit_selected</a></code>() function.</p></dd>


<dt id="arg-new-variables">new_variables<a class="anchor" aria-label="anchor" href="#arg-new-variables"></a></dt>
<dd><p>a SpatRaster or data.frame of predictor variables.
The names of these variables must match those used to calibrate the models or
those used to run PCA if <code>do_pca = TRUE</code> in the <code><a href="prepare_data.html">prepare_data</a></code>()
function.</p></dd>


<dt id="arg-mask">mask<a class="anchor" aria-label="anchor" href="#arg-mask"></a></dt>
<dd><p>(SpatRaster, SpatVector, or SpatExtent) spatial object used to
mask the variables before predict. Default is NULL.</p></dd>


<dt id="arg-write-files">write_files<a class="anchor" aria-label="anchor" href="#arg-write-files"></a></dt>
<dd><p>(logical) whether to save the predictions (SpatRasters or
data.frame) to disk. Default is FALSE.</p></dd>


<dt id="arg-write-replicates">write_replicates<a class="anchor" aria-label="anchor" href="#arg-write-replicates"></a></dt>
<dd><p>(logical) whether to save the predictions for each
replicates to disk. Only applicable if <code>write_files</code> is TRUE. Default is
FALSE.</p></dd>


<dt id="arg-out-dir">out_dir<a class="anchor" aria-label="anchor" href="#arg-out-dir"></a></dt>
<dd><p>(character) directory path where predictions will be saved.
Only relevant if <code>write_files = TRUE</code>.</p></dd>


<dt id="arg-consensus-per-model">consensus_per_model<a class="anchor" aria-label="anchor" href="#arg-consensus-per-model"></a></dt>
<dd><p>(logical) whether to compute consensus (mean,
median, etc.) for each model across its replicates. Default is TRUE.</p></dd>


<dt id="arg-consensus-general">consensus_general<a class="anchor" aria-label="anchor" href="#arg-consensus-general"></a></dt>
<dd><p>(logical) whether to compute a general consensus
across all models. Default is TRUE.</p></dd>


<dt id="arg-consensus">consensus<a class="anchor" aria-label="anchor" href="#arg-consensus"></a></dt>
<dd><p>(character) vector specifying the types of consensus to
calculate across replicates and models. Available options are <code>"median"</code>,
<code>"range"</code>, <code>"mean"</code>, and <code>"stdev"</code> (standard deviation). Default is
<code>c("median", "range", "mean", "stdev")</code>.</p></dd>


<dt id="arg-extrapolation-type">extrapolation_type<a class="anchor" aria-label="anchor" href="#arg-extrapolation-type"></a></dt>
<dd><p>(character) extrapolation type of model. Models can
be transferred with three options: free extrapolation ('E'), extrapolation
with clamping ('EC'), and no extrapolation ('NE'). Default = 'E'. See details.</p></dd>


<dt id="arg-var-to-clamp">var_to_clamp<a class="anchor" aria-label="anchor" href="#arg-var-to-clamp"></a></dt>
<dd><p>(character) vector specifying which variables to clamp or
not extrapolate. Only applicable if extrapolation_type is "EC" or "NE".
Default is <code>NULL</code>, meaning all variables will be clamped or not extrapolated.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>(character) the format of prediction values. For <code>maxnet</code> models,
valid options are <code>"raw"</code>, <code>"cumulative"</code>, <code>"logistic"</code>, and <code>"cloglog"</code>.
For <code>glm</code> models, valid options are <code>"cloglog"</code>, <code>"response"</code>, <code>"raw"</code>,
<code>"cumulative"</code> and <code>"link"</code>. Default is "cloglog.</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>(logical) whether to overwrite SpatRasters if they already
exist. Only applicable if <code>write_files = TRUE</code>. Default is FALSE.</p></dd>


<dt id="arg-progress-bar">progress_bar<a class="anchor" aria-label="anchor" href="#arg-progress-bar"></a></dt>
<dd><p>(logical) whether to display a progress bar during
processing. Default is TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing SpatRaster or data.frames predictions for each replicate,
long with the consensus results for each model and the overall general consensus.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When predicting to areas where the variables are beyond the lower or upper
limits of the calibration data, users can choose to free extrapolate the
predictions (<code>extrapolation_type = "E"</code>), extrapolate with clamping
(extrapolation_type = "EC"), or not extrapolate (extrapolation_type = "NE").
When clamping, the variables are set to minimum and maximum values
established for the maximum and minimum values within calibration data. In
the no extrapolation approach, any cell with at least one variable listed in
<code>var_to_clamp</code> falling outside the calibration range is assigned a suitability
value of 0.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Import variables to predict on</span></span></span>
<span class="r-in"><span><span class="va">var</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Current_variables.tif"</span>,</span></span>
<span class="r-in"><span>                               package <span class="op">=</span> <span class="st">"kuenm2"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example with maxnet</span></span></span>
<span class="r-in"><span><span class="co"># Import example of fitted_models (output of fit_selected())</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"fitted_model_maxnet"</span>, package <span class="op">=</span> <span class="st">"kuenm2"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predict to single scenario</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">predict_selected</span><span class="op">(</span>models <span class="op">=</span> <span class="va">fitted_model_maxnet</span>, new_variables <span class="op">=</span> <span class="va">var</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example with GLMs</span></span></span>
<span class="r-in"><span><span class="co"># Import example of fitted_models (output of fit_selected()) without replicates</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"fitted_model_glm"</span>, package <span class="op">=</span> <span class="st">"kuenm2"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predict to single scenario</span></span></span>
<span class="r-in"><span><span class="va">p_glm</span> <span class="op">&lt;-</span> <span class="fu">predict_selected</span><span class="op">(</span>models <span class="op">=</span> <span class="va">fitted_model_glm</span>, new_variables <span class="op">=</span> <span class="va">var</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot predictions</span></span></span>
<span class="r-in"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">General_consensus</span><span class="op">$</span><span class="va">median</span>, <span class="va">p_glm</span><span class="op">$</span><span class="va">General_consensus</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            col <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/flip.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">terrain.colors</a></span><span class="op">(</span><span class="fl">240</span><span class="op">)</span><span class="op">)</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MAXNET"</span>, <span class="st">"GLM"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict_selected-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Weverton C. F. Trindade, Luis F. Arias-Giraldo, Luis Osorio-Olvera, A. Townsend Peterson, Marlon E. Cobos.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

