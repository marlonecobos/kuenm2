<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit models selected after calibration — fit_selected • kuenm2</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit models selected after calibration — fit_selected"><meta name="description" content="This function fits models selected during model calibration()."><meta property="og:description" content="This function fits models selected during model calibration()."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">kuenm2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.11</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/basic_data_cleaning.html">1. Basic Data Cleaning</a></li>
    <li><a class="dropdown-item" href="../articles/prepare_data.html">2. Prepare Data for Model Calibration</a></li>
    <li><a class="dropdown-item" href="../articles/model_calibration.html">3. Model Calibration</a></li>
    <li><a class="dropdown-item" href="../articles/model_exploration.html">4. Fit and Explore Selected Models</a></li>
    <li><a class="dropdown-item" href="../articles/model_predictions.html">5. Project Models to a Single Scenario</a></li>
    <li><a class="dropdown-item" href="../articles/model_projections.html">6. Project Models to Multiple Scenarios</a></li>
    <li><a class="dropdown-item" href="../articles/variability_and_uncertainty.html">7. Exploring Model Uncertainty and Variability</a></li>
    <li><a class="dropdown-item" href="../articles/projections_chelsa.html">8. Example of Projections Using CHELSA Data</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/marlonecobos/kuenm2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fit models selected after calibration</h1>
      <small class="dont-index">Source: <a href="https://github.com/marlonecobos/kuenm2/blob/main/R/fit_selected.R" class="external-link"><code>R/fit_selected.R</code></a></small>
      <div class="d-none name"><code>fit_selected.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function fits models selected during model <code><a href="calibration.html">calibration()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_selected</span><span class="op">(</span><span class="va">calibration_results</span>, replicate_method <span class="op">=</span> <span class="st">"kfolds"</span>,</span>
<span>             n_replicates <span class="op">=</span> <span class="fl">1</span>, sample_proportion <span class="op">=</span> <span class="fl">0.7</span>, type <span class="op">=</span> <span class="st">"cloglog"</span>,</span>
<span>             write_models <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>             file_name <span class="op">=</span> <span class="cn">NULL</span>, parallel <span class="op">=</span> <span class="cn">FALSE</span>, ncores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>             progress_bar <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-calibration-results">calibration_results<a class="anchor" aria-label="anchor" href="#arg-calibration-results"></a></dt>
<dd><p>an object of class <code>calibration_results</code> returned
by the <code><a href="calibration.html">calibration()</a></code> function.</p></dd>


<dt id="arg-replicate-method">replicate_method<a class="anchor" aria-label="anchor" href="#arg-replicate-method"></a></dt>
<dd><p>(character) method used for producing replicates.
Available options are <code>"kfolds"</code>, <code>"subsample"</code>, and <code>"bootstrap"</code>.
See <strong>Details</strong> for more information.</p></dd>


<dt id="arg-n-replicates">n_replicates<a class="anchor" aria-label="anchor" href="#arg-n-replicates"></a></dt>
<dd><p>(numeric) number of replicates or folds to generate. If
<code>replicate_method</code> is <code>"subsample"</code> or <code>"bootstrap"</code>, this defines the number
of replicates. If <code>"kfolds"</code>, it specifies the number of folds. Default is 4.</p></dd>


<dt id="arg-sample-proportion">sample_proportion<a class="anchor" aria-label="anchor" href="#arg-sample-proportion"></a></dt>
<dd><p>(numeric) proportion of occurrence and background
points to be used to fit model replicates. Only applicable when
<code>replicate_method</code> is <code>"subsample"</code> or <code>"bootstrap"</code>. Default is 0.7 (i.e.,
70% of the data).</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>(character) the format of prediction values for computing
thresholds. For maxnet models, valid options are "raw", "cumulative",
"logistic", and "cloglog". For glm models, valid options are "cloglog",
"response" and "raw". Default is "cloglog".</p></dd>


<dt id="arg-write-models">write_models<a class="anchor" aria-label="anchor" href="#arg-write-models"></a></dt>
<dd><p>(logical) whether to save the final fitted models to disk.
Default is FALSE.</p></dd>


<dt id="arg-file-name">file_name<a class="anchor" aria-label="anchor" href="#arg-file-name"></a></dt>
<dd><p>(character) the file name, with or without a path, for saving
the final models. This is only applicable if <code>write_models = TRUE</code>.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>(logical) whether to fit the final models in parallel. Default
is FALSE.</p></dd>


<dt id="arg-ncores">ncores<a class="anchor" aria-label="anchor" href="#arg-ncores"></a></dt>
<dd><p>(numeric) number of cores to use for parallel processing.
Default is NULL and uses available cores - 1. This is only applicable if
<code>parallel = TRUE</code>.</p></dd>


<dt id="arg-progress-bar">progress_bar<a class="anchor" aria-label="anchor" href="#arg-progress-bar"></a></dt>
<dd><p>(logical) whether to display a progress bar during processing.
Default is TRUE.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>(logical) whether to display detailed messages during processing.
Default is TRUE.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>(numeric) integer value used to specify an initial seed to split
the data. Default is 1.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class 'fitted_models' containing the following elements:</p>
<dl><dt>species</dt>
<dd><p>a character string with the name of the species.</p></dd>

<dt>Models</dt>
<dd><p>a list of fitted models, including replicates (fitted with
part of the data) and full models (fitted with all data).</p></dd>

<dt>calibration_data</dt>
<dd><p>a data.frame containing a column (<code>pr_bg</code>) that
identifies occurrence points (1) and background points (0), along with the
corresponding values of predictor variables for each point.</p></dd>

<dt>selected_models</dt>
<dd><p>a data frame with the ID and summary of evaluation
metrics for the selected models.</p></dd>

<dt>weights</dt>
<dd><p>a numeric vector specifying weights for the predictor variables
(if used).</p></dd>

<dt>pca</dt>
<dd><p>a list of class <code><a href="https://rspatial.github.io/terra/reference/prcomp.html" class="external-link">prcomp</a></code> representing the
result of principal component analysis (if performed).</p></dd>

<dt>addsamplestobackground</dt>
<dd><p>a logical value indicating whether any presence
sample not already in the background was added.</p></dd>

<dt>omission_rate</dt>
<dd><p>the omission rate determined during the calibration step.</p></dd>

<dt>thresholds</dt>
<dd><p>the thresholds to binarize each replicate and the consensus
(mean and median), calculated based on the omission rate set in
<code><a href="calibration.html">calibration()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function also computes model consensus (mean and median), the thresholds
to binarize model predictions based on the omission rate set during model
calibration to select models.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># An example with maxnet models</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">calib_results_maxnet</span>, package <span class="op">=</span> <span class="st">"kuenm2"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit models using calibration results</span></span></span>
<span class="r-in"><span><span class="va">fm</span> <span class="op">&lt;-</span> <span class="fu">fit_selected</span><span class="op">(</span>calibration_results <span class="op">=</span> <span class="va">calib_results_maxnet</span>,</span></span>
<span class="r-in"><span>                   n_replicates <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fitting replicates...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=========                                                             |  12%  |                                                                              |==================                                                    |  25%  |                                                                              |==========================                                            |  38%  |                                                                              |===================================                                   |  50%  |                                                                              |============================================                          |  62%  |                                                                              |====================================================                  |  75%  |                                                                              |=============================================================         |  88%  |                                                                              |======================================================================| 100%</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fitting full models...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Output the fitted models</span></span></span>
<span class="r-in"><span><span class="va">fm</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fitted_models object summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ============================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species: Myrcia hatschbachii </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Algortihm: maxnet </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of fitted models: 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Models fitted with 4 replicates</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># An example with GLMs</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">calib_results_glm</span>, package <span class="op">=</span> <span class="st">"kuenm2"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit models using calibration results</span></span></span>
<span class="r-in"><span><span class="va">fm_glm</span> <span class="op">&lt;-</span> <span class="fu">fit_selected</span><span class="op">(</span>calibration_results <span class="op">=</span> <span class="va">calib_results_glm</span>,</span></span>
<span class="r-in"><span>                       replicate_method <span class="op">=</span> <span class="st">"subsample"</span>,</span></span>
<span class="r-in"><span>                       n_replicates <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fitting replicates...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |==============                                                        |  20%  |                                                                              |============================                                          |  40%  |                                                                              |==========================================                            |  60%  |                                                                              |========================================================              |  80%  |                                                                              |======================================================================| 100%</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fitting full models...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Output the fitted models</span></span></span>
<span class="r-in"><span><span class="va">fm_glm</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fitted_models object summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ============================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species: Myrcia hatschbachii </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Algortihm: glm </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of fitted models: 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Models fitted with 5 replicates</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Weverton C. F. Trindade, Luis F. Arias-Giraldo, Luis Osorio-Olvera, A. Townsend Peterson, Marlon E. Cobos.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

